<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RoomMatch API Documentation</title>
  <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css">
  <link rel="icon" type="image/png" href="https://unpkg.com/swagger-ui-dist@5.9.0/favicon-32x32.png" sizes="32x32">
  <style>
    html { box-sizing: border-box; overflow-y: scroll; }
    *, *:before, *:after { box-sizing: inherit; }
    body { margin: 0; background: #fafafa; }
    .swagger-ui .topbar { display: none; }
    .swagger-ui .info { margin: 30px 0; }
    .swagger-ui .info .title { color: #10b981; }
    .swagger-ui .scheme-container { background: #f8fafc; padding: 20px 0; }
    .swagger-ui .btn.authorize { background-color: #10b981; border-color: #10b981; }
    .swagger-ui .btn.authorize:hover { background-color: #059669; }
    .swagger-ui .opblock.opblock-post { border-color: #10b981; background: rgba(16, 185, 129, 0.1); }
    .swagger-ui .opblock.opblock-post .opblock-summary-method { background: #10b981; }
    .swagger-ui .opblock.opblock-get { border-color: #3b82f6; background: rgba(59, 130, 246, 0.1); }
    .swagger-ui .opblock.opblock-get .opblock-summary-method { background: #3b82f6; }
    .swagger-ui .opblock.opblock-put { border-color: #f59e0b; background: rgba(245, 158, 11, 0.1); }
    .swagger-ui .opblock.opblock-put .opblock-summary-method { background: #f59e0b; }
    .swagger-ui .opblock.opblock-patch { border-color: #8b5cf6; background: rgba(139, 92, 246, 0.1); }
    .swagger-ui .opblock.opblock-patch .opblock-summary-method { background: #8b5cf6; }
    .swagger-ui .opblock.opblock-delete { border-color: #ef4444; background: rgba(239, 68, 68, 0.1); }
    .swagger-ui .opblock.opblock-delete .opblock-summary-method { background: #ef4444; }
    .custom-header {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      padding: 20px 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .custom-header h1 { margin: 0; font-size: 24px; font-weight: 600; }
    .custom-header p { margin: 5px 0 0; opacity: 0.9; font-size: 14px; }
    .custom-header .version {
      background: rgba(255,255,255,0.2);
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="custom-header">
    <div>
      <h1> RoomMatch API</h1>
      <p>API para conectar propietarios con personas que buscan compartir arriendo</p>
    </div>
    <span class="version">v1.0.0</span>
  </div>
  <div id="swagger-ui"></div>

  <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
  <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
  <script>
    window.onload = function() {
      const spec = {
        "openapi": "3.0.0",
        "info": {
          "title": "RoomMatch API",
          "version": "1.0.0",
          "description": "API REST para la plataforma RoomMatch que conecta propietarios con personas que buscan compartir arriendo en Chile.\n\n## Autenticaci贸n\nLa API utiliza JWT (JSON Web Tokens) para autenticaci贸n. Incluye el token en el header:\n```\nAuthorization: Bearer <token>\n```\n\n## Roles\n- **ADMIN**: Administrador del sistema\n- **PROPIETARIO**: Due帽o de propiedades\n- **ROOMIE**: Usuario que busca o tiene habitaci贸n",
          "contact": {
            "name": "RoomMatch Team",
            "email": "soporte@roommatch.cl"
          }
        },
        "servers": [
          {
            "url": "http://localhost:3000/api",
            "description": "Servidor de desarrollo"
          },
          {
            "url": "https://api.roommatch.cl/api",
            "description": "Servidor de producci贸n"
          }
        ],
        "tags": [
          { "name": "Auth", "description": "Autenticaci贸n y gesti贸n de sesiones" },
          { "name": "Users", "description": "Gesti贸n de usuarios y perfiles" },
          { "name": "Properties", "description": "Gesti贸n de propiedades" },
          { "name": "Rooms", "description": "Gesti贸n de habitaciones" },
          { "name": "Requests", "description": "Solicitudes de arriendo" },
          { "name": "Matches", "description": "Matches y contratos de arriendo" },
          { "name": "Messages", "description": "Sistema de mensajer铆a" }
        ],
        "paths": {
          "/auth/login": {
            "post": {
              "tags": ["Auth"],
              "summary": "Iniciar sesi贸n",
              "description": "Autentica un usuario y devuelve un token JWT",
              "security": [],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/LoginRequest" },
                    "example": {
                      "email": "carlos.mendez@email.com",
                      "password": "password123"
                    }
                  }
                }
              },
              "responses": {
                "200": {
                  "description": "Login exitoso",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/AuthResponse" }
                    }
                  }
                },
                "401": { "description": "Credenciales inv谩lidas" }
              }
            }
          },
          "/auth/register": {
            "post": {
              "tags": ["Auth"],
              "summary": "Registrar nuevo usuario",
              "description": "Crea una nueva cuenta de usuario (Propietario o Roomie)",
              "security": [],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/RegisterRequest" },
                    "example": {
                      "email": "nuevo@email.com",
                      "password": "password123",
                      "firstName": "Juan",
                      "lastName": "P茅rez",
                      "phone": "+56912345678",
                      "role": "ROOMIE",
                      "hasRoom": false
                    }
                  }
                }
              },
              "responses": {
                "201": {
                  "description": "Usuario registrado exitosamente",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/AuthResponse" }
                    }
                  }
                },
                "409": { "description": "El email ya est谩 registrado" }
              }
            }
          },
          "/auth/me": {
            "get": {
              "tags": ["Auth"],
              "summary": "Obtener usuario actual",
              "description": "Devuelve los datos del usuario autenticado",
              "responses": {
                "200": {
                  "description": "Datos del usuario",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/User" }
                    }
                  }
                },
                "401": { "description": "No autorizado" }
              }
            }
          },
          "/auth/change-password": {
            "post": {
              "tags": ["Auth"],
              "summary": "Cambiar contrase帽a",
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "required": ["currentPassword", "newPassword"],
                      "properties": {
                        "currentPassword": { "type": "string" },
                        "newPassword": { "type": "string", "minLength": 6 }
                      }
                    }
                  }
                }
              },
              "responses": {
                "200": { "description": "Contrase帽a actualizada" },
                "400": { "description": "Contrase帽a actual incorrecta" }
              }
            }
          },
          "/auth/refresh": {
            "post": {
              "tags": ["Auth"],
              "summary": "Refrescar token",
              "responses": {
                "200": {
                  "description": "Nuevo token generado",
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "token": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "/users": {
            "get": {
              "tags": ["Users"],
              "summary": "Listar usuarios (Admin)",
              "description": "Lista todos los usuarios con filtros opcionales. Solo para administradores.",
              "parameters": [
                { "name": "role", "in": "query", "schema": { "type": "string", "enum": ["ADMIN", "PROPIETARIO", "ROOMIE"] } },
                { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["ACTIVE", "INACTIVE", "PENDING", "BANNED"] } },
                { "name": "search", "in": "query", "schema": { "type": "string" }, "description": "Buscar por email" },
                { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
                { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } }
              ],
              "responses": {
                "200": {
                  "description": "Lista de usuarios",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/PaginatedUsers" }
                    }
                  }
                }
              }
            }
          },
          "/users/{id}": {
            "get": {
              "tags": ["Users"],
              "summary": "Obtener usuario por ID",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": {
                  "description": "Datos del usuario",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/User" }
                    }
                  }
                },
                "404": { "description": "Usuario no encontrado" }
              }
            },
            "patch": {
              "tags": ["Users"],
              "summary": "Actualizar usuario",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/UpdateUser" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Usuario actualizado" }
              }
            },
            "delete": {
              "tags": ["Users"],
              "summary": "Eliminar usuario (Admin)",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Usuario eliminado" }
              }
            }
          },
          "/users/{id}/status": {
            "patch": {
              "tags": ["Users"],
              "summary": "Actualizar estado de usuario (Admin)",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "required": ["status"],
                      "properties": {
                        "status": { "type": "string", "enum": ["ACTIVE", "INACTIVE", "PENDING", "BANNED"] }
                      }
                    }
                  }
                }
              },
              "responses": {
                "200": { "description": "Estado actualizado" }
              }
            }
          },
          "/users/profile/roomie": {
            "get": {
              "tags": ["Users"],
              "summary": "Obtener mi perfil de roomie",
              "responses": {
                "200": {
                  "description": "Perfil de roomie",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/RoomieProfile" }
                    }
                  }
                }
              }
            },
            "patch": {
              "tags": ["Users"],
              "summary": "Actualizar mi perfil de roomie",
              "requestBody": {
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/UpdateRoomieProfile" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Perfil actualizado" }
              }
            }
          },
          "/users/roomies": {
            "get": {
              "tags": ["Users"],
              "summary": "Buscar roomies",
              "description": "Lista roomies activos con filtros opcionales",
              "parameters": [
                { "name": "hasRoom", "in": "query", "schema": { "type": "boolean" }, "description": "true: tiene habitaci贸n, false: busca habitaci贸n" },
                { "name": "comuna", "in": "query", "schema": { "type": "string" } },
                { "name": "budgetMin", "in": "query", "schema": { "type": "number" } },
                { "name": "budgetMax", "in": "query", "schema": { "type": "number" } },
                { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
                { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } }
              ],
              "responses": {
                "200": { "description": "Lista de roomies" }
              }
            }
          },
          "/properties": {
            "get": {
              "tags": ["Properties"],
              "summary": "Listar propiedades",
              "description": "Lista propiedades disponibles con filtros",
              "parameters": [
                { "name": "comuna", "in": "query", "schema": { "type": "string" } },
                { "name": "city", "in": "query", "schema": { "type": "string" } },
                { "name": "type", "in": "query", "schema": { "type": "string", "enum": ["APARTMENT", "HOUSE", "STUDIO", "LOFT", "SHARED_APARTMENT"] } },
                { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["AVAILABLE", "OCCUPIED", "INACTIVE"] } },
                { "name": "priceMin", "in": "query", "schema": { "type": "number" } },
                { "name": "priceMax", "in": "query", "schema": { "type": "number" } },
                { "name": "rooms", "in": "query", "schema": { "type": "integer" } },
                { "name": "bathrooms", "in": "query", "schema": { "type": "integer" } },
                { "name": "petsAllowed", "in": "query", "schema": { "type": "boolean" } },
                { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
                { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } }
              ],
              "responses": {
                "200": {
                  "description": "Lista de propiedades",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/PaginatedProperties" }
                    }
                  }
                }
              }
            },
            "post": {
              "tags": ["Properties"],
              "summary": "Crear propiedad (Propietario)",
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/CreateProperty" }
                  }
                }
              },
              "responses": {
                "201": {
                  "description": "Propiedad creada",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/Property" }
                    }
                  }
                }
              }
            }
          },
          "/properties/my": {
            "get": {
              "tags": ["Properties"],
              "summary": "Mis propiedades (Propietario)",
              "responses": {
                "200": { "description": "Lista de mis propiedades" }
              }
            }
          },
          "/properties/stats": {
            "get": {
              "tags": ["Properties"],
              "summary": "Estad铆sticas de mis propiedades",
              "responses": {
                "200": {
                  "description": "Estad铆sticas",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/PropertyStats" }
                    }
                  }
                }
              }
            }
          },
          "/properties/{id}": {
            "get": {
              "tags": ["Properties"],
              "summary": "Obtener propiedad por ID",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": {
                  "description": "Datos de la propiedad",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/Property" }
                    }
                  }
                }
              }
            },
            "patch": {
              "tags": ["Properties"],
              "summary": "Actualizar propiedad",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/UpdateProperty" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Propiedad actualizada" }
              }
            },
            "delete": {
              "tags": ["Properties"],
              "summary": "Eliminar propiedad",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Propiedad eliminada" }
              }
            }
          },
          "/properties/{id}/status": {
            "patch": {
              "tags": ["Properties"],
              "summary": "Actualizar estado de propiedad",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "status": { "type": "string", "enum": ["AVAILABLE", "OCCUPIED", "INACTIVE"] }
                      }
                    }
                  }
                }
              },
              "responses": {
                "200": { "description": "Estado actualizado" }
              }
            }
          },
          "/properties/{id}/verify": {
            "patch": {
              "tags": ["Properties"],
              "summary": "Verificar propiedad (Admin)",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Propiedad verificada" }
              }
            }
          },
          "/rooms": {
            "get": {
              "tags": ["Rooms"],
              "summary": "Listar habitaciones",
              "parameters": [
                { "name": "propertyId", "in": "query", "schema": { "type": "string", "format": "uuid" } },
                { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["AVAILABLE", "RESERVED", "OCCUPIED", "UNAVAILABLE"] } },
                { "name": "priceMin", "in": "query", "schema": { "type": "number" } },
                { "name": "priceMax", "in": "query", "schema": { "type": "number" } },
                { "name": "hasPrivateBathroom", "in": "query", "schema": { "type": "boolean" } }
              ],
              "responses": {
                "200": { "description": "Lista de habitaciones" }
              }
            },
            "post": {
              "tags": ["Rooms"],
              "summary": "Crear habitaci贸n (Propietario)",
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/CreateRoom" }
                  }
                }
              },
              "responses": {
                "201": { "description": "Habitaci贸n creada" }
              }
            }
          },
          "/rooms/property/{propertyId}": {
            "get": {
              "tags": ["Rooms"],
              "summary": "Habitaciones de una propiedad",
              "parameters": [
                { "name": "propertyId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Lista de habitaciones" }
              }
            }
          },
          "/rooms/{id}": {
            "get": {
              "tags": ["Rooms"],
              "summary": "Obtener habitaci贸n por ID",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": {
                  "description": "Datos de la habitaci贸n",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/Room" }
                    }
                  }
                }
              }
            },
            "patch": {
              "tags": ["Rooms"],
              "summary": "Actualizar habitaci贸n",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/UpdateRoom" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Habitaci贸n actualizada" }
              }
            },
            "delete": {
              "tags": ["Rooms"],
              "summary": "Eliminar habitaci贸n",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Habitaci贸n eliminada" }
              }
            }
          },
          "/requests": {
            "post": {
              "tags": ["Requests"],
              "summary": "Crear solicitud (Roomie)",
              "description": "Un roomie env铆a una solicitud para arrendar una habitaci贸n",
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/CreateRequest" }
                  }
                }
              },
              "responses": {
                "201": { "description": "Solicitud creada" },
                "409": { "description": "Ya tienes una solicitud pendiente para esta habitaci贸n" }
              }
            }
          },
          "/requests/my": {
            "get": {
              "tags": ["Requests"],
              "summary": "Mis solicitudes enviadas (Roomie)",
              "parameters": [
                { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["PENDING", "ACCEPTED", "REJECTED", "CANCELLED", "EXPIRED"] } }
              ],
              "responses": {
                "200": { "description": "Lista de solicitudes enviadas" }
              }
            }
          },
          "/requests/received": {
            "get": {
              "tags": ["Requests"],
              "summary": "Solicitudes recibidas (Propietario)",
              "parameters": [
                { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["PENDING", "ACCEPTED", "REJECTED", "CANCELLED", "EXPIRED"] } }
              ],
              "responses": {
                "200": { "description": "Lista de solicitudes recibidas" }
              }
            }
          },
          "/requests/stats": {
            "get": {
              "tags": ["Requests"],
              "summary": "Estad铆sticas de solicitudes",
              "responses": {
                "200": {
                  "description": "Estad铆sticas",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/RequestStats" }
                    }
                  }
                }
              }
            }
          },
          "/requests/{id}": {
            "get": {
              "tags": ["Requests"],
              "summary": "Obtener solicitud por ID",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Datos de la solicitud" }
              }
            }
          },
          "/requests/{id}/respond": {
            "post": {
              "tags": ["Requests"],
              "summary": "Responder solicitud (Propietario)",
              "description": "Acepta o rechaza una solicitud. Si se acepta, crea un match autom谩ticamente.",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/RespondRequest" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Solicitud respondida" }
              }
            }
          },
          "/requests/{id}/cancel": {
            "post": {
              "tags": ["Requests"],
              "summary": "Cancelar solicitud (Roomie)",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Solicitud cancelada" }
              }
            }
          },
          "/matches": {
            "get": {
              "tags": ["Matches"],
              "summary": "Mis matches",
              "description": "Lista los matches del usuario (seg煤n su rol)",
              "parameters": [
                { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["ACTIVE", "PENDING_PAYMENT", "CONFIRMED", "COMPLETED", "CANCELLED"] } }
              ],
              "responses": {
                "200": { "description": "Lista de matches" }
              }
            }
          },
          "/matches/stats": {
            "get": {
              "tags": ["Matches"],
              "summary": "Estad铆sticas de matches",
              "responses": {
                "200": {
                  "description": "Estad铆sticas",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/MatchStats" }
                    }
                  }
                }
              }
            }
          },
          "/matches/{id}": {
            "get": {
              "tags": ["Matches"],
              "summary": "Obtener match por ID",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Datos del match" }
              }
            },
            "patch": {
              "tags": ["Matches"],
              "summary": "Actualizar match (Propietario)",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/UpdateMatch" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Match actualizado" }
              }
            }
          },
          "/matches/{id}/rate/owner": {
            "post": {
              "tags": ["Matches"],
              "summary": "Calificar propietario (Roomie)",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/RateMatch" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Calificaci贸n registrada" }
              }
            }
          },
          "/matches/{id}/rate/roomie": {
            "post": {
              "tags": ["Matches"],
              "summary": "Calificar roomie (Propietario)",
              "parameters": [
                { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/RateMatch" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Calificaci贸n registrada" }
              }
            }
          },
          "/messages/conversations": {
            "get": {
              "tags": ["Messages"],
              "summary": "Listar conversaciones",
              "responses": {
                "200": {
                  "description": "Lista de conversaciones",
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "array",
                        "items": { "$ref": "#/components/schemas/Conversation" }
                      }
                    }
                  }
                }
              }
            }
          },
          "/messages/conversations/{conversationId}": {
            "get": {
              "tags": ["Messages"],
              "summary": "Obtener mensajes de una conversaci贸n",
              "parameters": [
                { "name": "conversationId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
                { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
                { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 50 } }
              ],
              "responses": {
                "200": { "description": "Lista de mensajes" }
              }
            }
          },
          "/messages/conversations/{conversationId}/read": {
            "post": {
              "tags": ["Messages"],
              "summary": "Marcar mensajes como le铆dos",
              "parameters": [
                { "name": "conversationId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
              ],
              "responses": {
                "200": { "description": "Mensajes marcados como le铆dos" }
              }
            }
          },
          "/messages": {
            "post": {
              "tags": ["Messages"],
              "summary": "Enviar mensaje",
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/SendMessage" }
                  }
                }
              },
              "responses": {
                "201": { "description": "Mensaje enviado" }
              }
            }
          },
          "/messages/unread": {
            "get": {
              "tags": ["Messages"],
              "summary": "Contar mensajes no le铆dos",
              "responses": {
                "200": {
                  "description": "Conteo de mensajes no le铆dos",
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "unread": { "type": "integer" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "components": {
          "securitySchemes": {
            "bearerAuth": {
              "type": "http",
              "scheme": "bearer",
              "bearerFormat": "JWT",
              "description": "Ingresa tu token JWT"
            }
          },
          "schemas": {
            "LoginRequest": {
              "type": "object",
              "required": ["email", "password"],
              "properties": {
                "email": { "type": "string", "format": "email" },
                "password": { "type": "string", "minLength": 6 }
              }
            },
            "RegisterRequest": {
              "type": "object",
              "required": ["email", "password", "firstName", "lastName", "role"],
              "properties": {
                "email": { "type": "string", "format": "email" },
                "password": { "type": "string", "minLength": 6 },
                "firstName": { "type": "string" },
                "lastName": { "type": "string" },
                "phone": { "type": "string" },
                "role": { "type": "string", "enum": ["PROPIETARIO", "ROOMIE"] },
                "hasRoom": { "type": "boolean", "description": "Solo para ROOMIE: true si ofrece habitaci贸n, false si busca" }
              }
            },
            "AuthResponse": {
              "type": "object",
              "properties": {
                "user": { "$ref": "#/components/schemas/User" },
                "token": { "type": "string" }
              }
            },
            "User": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "format": "uuid" },
                "email": { "type": "string", "format": "email" },
                "firstName": { "type": "string" },
                "lastName": { "type": "string" },
                "phone": { "type": "string" },
                "avatar": { "type": "string" },
                "role": { "type": "string", "enum": ["ADMIN", "PROPIETARIO", "ROOMIE"] },
                "status": { "type": "string", "enum": ["ACTIVE", "INACTIVE", "PENDING", "BANNED"] },
                "emailVerified": { "type": "boolean" },
                "createdAt": { "type": "string", "format": "date-time" }
              }
            },
            "UpdateUser": {
              "type": "object",
              "properties": {
                "firstName": { "type": "string" },
                "lastName": { "type": "string" },
                "phone": { "type": "string" },
                "avatar": { "type": "string" }
              }
            },
            "RoomieProfile": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "format": "uuid" },
                "userId": { "type": "string", "format": "uuid" },
                "hasRoom": { "type": "boolean" },
                "birthdate": { "type": "string", "format": "date" },
                "gender": { "type": "string", "enum": ["MALE", "FEMALE", "NON_BINARY", "PREFER_NOT_TO_SAY"] },
                "occupation": { "type": "string", "enum": ["STUDENT", "PROFESSIONAL", "REMOTE_WORKER", "ENTREPRENEUR", "OTHER"] },
                "bio": { "type": "string" },
                "preferences": { "type": "object" },
                "lifestyle": { "type": "object" },
                "interests": { "type": "array", "items": { "type": "string" } },
                "languages": { "type": "array", "items": { "type": "string" } },
                "profileCompletion": { "type": "integer" }
              }
            },
            "UpdateRoomieProfile": {
              "type": "object",
              "properties": {
                "hasRoom": { "type": "boolean" },
                "birthdate": { "type": "string", "format": "date" },
                "gender": { "type": "string", "enum": ["MALE", "FEMALE", "NON_BINARY", "PREFER_NOT_TO_SAY"] },
                "occupation": { "type": "string", "enum": ["STUDENT", "PROFESSIONAL", "REMOTE_WORKER", "ENTREPRENEUR", "OTHER"] },
                "bio": { "type": "string" },
                "preferences": {
                  "type": "object",
                  "properties": {
                    "preferredLocations": { "type": "array", "items": { "type": "string" } },
                    "budgetMin": { "type": "number" },
                    "budgetMax": { "type": "number" },
                    "moveInDate": { "type": "string" },
                    "petFriendly": { "type": "boolean" },
                    "smokingAllowed": { "type": "boolean" }
                  }
                },
                "interests": { "type": "array", "items": { "type": "string" } }
              }
            },
            "PaginatedUsers": {
              "type": "object",
              "properties": {
                "data": { "type": "array", "items": { "$ref": "#/components/schemas/User" } },
                "meta": { "$ref": "#/components/schemas/PaginationMeta" }
              }
            },
            "Property": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "format": "uuid" },
                "ownerId": { "type": "string", "format": "uuid" },
                "title": { "type": "string" },
                "description": { "type": "string" },
                "type": { "type": "string", "enum": ["APARTMENT", "HOUSE", "STUDIO", "LOFT", "SHARED_APARTMENT"] },
                "status": { "type": "string", "enum": ["AVAILABLE", "OCCUPIED", "INACTIVE"] },
                "address": { "$ref": "#/components/schemas/Address" },
                "features": { "$ref": "#/components/schemas/PropertyFeatures" },
                "rules": { "$ref": "#/components/schemas/PropertyRules" },
                "monthlyRent": { "type": "number" },
                "commonExpenses": { "type": "number" },
                "depositMonths": { "type": "integer" },
                "images": { "type": "array", "items": { "type": "string" } },
                "availableFrom": { "type": "string", "format": "date" },
                "minimumStay": { "type": "integer" },
                "views": { "type": "integer" },
                "isVerified": { "type": "boolean" },
                "createdAt": { "type": "string", "format": "date-time" }
              }
            },
            "CreateProperty": {
              "type": "object",
              "required": ["title", "type", "address", "features", "monthlyRent"],
              "properties": {
                "title": { "type": "string" },
                "description": { "type": "string" },
                "type": { "type": "string", "enum": ["APARTMENT", "HOUSE", "STUDIO", "LOFT", "SHARED_APARTMENT"] },
                "address": { "$ref": "#/components/schemas/Address" },
                "features": { "$ref": "#/components/schemas/PropertyFeatures" },
                "rules": { "$ref": "#/components/schemas/PropertyRules" },
                "monthlyRent": { "type": "number" },
                "commonExpenses": { "type": "number" },
                "depositMonths": { "type": "integer" },
                "images": { "type": "array", "items": { "type": "string" } },
                "availableFrom": { "type": "string", "format": "date" },
                "minimumStay": { "type": "integer" }
              }
            },
            "UpdateProperty": {
              "type": "object",
              "properties": {
                "title": { "type": "string" },
                "description": { "type": "string" },
                "type": { "type": "string", "enum": ["APARTMENT", "HOUSE", "STUDIO", "LOFT", "SHARED_APARTMENT"] },
                "status": { "type": "string", "enum": ["AVAILABLE", "OCCUPIED", "INACTIVE"] },
                "monthlyRent": { "type": "number" },
                "commonExpenses": { "type": "number" }
              }
            },
            "Address": {
              "type": "object",
              "required": ["street", "number", "comuna", "city", "region"],
              "properties": {
                "street": { "type": "string" },
                "number": { "type": "string" },
                "apartment": { "type": "string" },
                "comuna": { "type": "string" },
                "city": { "type": "string" },
                "region": { "type": "string" },
                "zipCode": { "type": "string" },
                "coordinates": {
                  "type": "object",
                  "properties": {
                    "lat": { "type": "number" },
                    "lng": { "type": "number" }
                  }
                }
              }
            },
            "PropertyFeatures": {
              "type": "object",
              "required": ["totalRooms", "availableRooms", "bathrooms", "squareMeters"],
              "properties": {
                "totalRooms": { "type": "integer" },
                "availableRooms": { "type": "integer" },
                "bathrooms": { "type": "integer" },
                "squareMeters": { "type": "number" },
                "floor": { "type": "integer" },
                "hasElevator": { "type": "boolean" },
                "hasParking": { "type": "boolean" },
                "hasFurniture": { "type": "boolean" },
                "hasWifi": { "type": "boolean" },
                "hasAC": { "type": "boolean" },
                "hasHeating": { "type": "boolean" },
                "hasWasher": { "type": "boolean" },
                "hasBalcony": { "type": "boolean" },
                "hasGym": { "type": "boolean" },
                "hasSecurity": { "type": "boolean" }
              }
            },
            "PropertyRules": {
              "type": "object",
              "properties": {
                "petsAllowed": { "type": "boolean" },
                "smokingAllowed": { "type": "boolean" },
                "childrenAllowed": { "type": "boolean" },
                "maxOccupants": { "type": "integer" },
                "quietHoursStart": { "type": "string" },
                "quietHoursEnd": { "type": "string" },
                "guestsAllowed": { "type": "boolean" },
                "partiesAllowed": { "type": "boolean" }
              }
            },
            "PaginatedProperties": {
              "type": "object",
              "properties": {
                "data": { "type": "array", "items": { "$ref": "#/components/schemas/Property" } },
                "meta": { "$ref": "#/components/schemas/PaginationMeta" }
              }
            },
            "PropertyStats": {
              "type": "object",
              "properties": {
                "total": { "type": "integer" },
                "available": { "type": "integer" },
                "occupied": { "type": "integer" },
                "inactive": { "type": "integer" },
                "totalViews": { "type": "integer" }
              }
            },
            "Room": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "format": "uuid" },
                "propertyId": { "type": "string", "format": "uuid" },
                "name": { "type": "string" },
                "description": { "type": "string" },
                "status": { "type": "string", "enum": ["AVAILABLE", "RESERVED", "OCCUPIED", "UNAVAILABLE"] },
                "squareMeters": { "type": "number" },
                "bedType": { "type": "string", "enum": ["SINGLE", "DOUBLE", "QUEEN", "KING", "NONE"] },
                "hasPrivateBathroom": { "type": "boolean" },
                "hasCloset": { "type": "boolean" },
                "hasDesk": { "type": "boolean" },
                "isFurnished": { "type": "boolean" },
                "monthlyRent": { "type": "number" },
                "images": { "type": "array", "items": { "type": "string" } },
                "availableFrom": { "type": "string", "format": "date" }
              }
            },
            "CreateRoom": {
              "type": "object",
              "required": ["propertyId", "name", "monthlyRent"],
              "properties": {
                "propertyId": { "type": "string", "format": "uuid" },
                "name": { "type": "string" },
                "description": { "type": "string" },
                "squareMeters": { "type": "number" },
                "bedType": { "type": "string", "enum": ["SINGLE", "DOUBLE", "QUEEN", "KING", "NONE"] },
                "hasPrivateBathroom": { "type": "boolean" },
                "monthlyRent": { "type": "number" },
                "images": { "type": "array", "items": { "type": "string" } }
              }
            },
            "UpdateRoom": {
              "type": "object",
              "properties": {
                "name": { "type": "string" },
                "description": { "type": "string" },
                "status": { "type": "string", "enum": ["AVAILABLE", "RESERVED", "OCCUPIED", "UNAVAILABLE"] },
                "monthlyRent": { "type": "number" }
              }
            },
            "CreateRequest": {
              "type": "object",
              "required": ["roomId"],
              "properties": {
                "roomId": { "type": "string", "format": "uuid" },
                "message": { "type": "string", "description": "Mensaje para el propietario" },
                "proposedMoveIn": { "type": "string", "format": "date" },
                "proposedStayMonths": { "type": "integer" }
              }
            },
            "RespondRequest": {
              "type": "object",
              "required": ["status"],
              "properties": {
                "status": { "type": "string", "enum": ["ACCEPTED", "REJECTED"] },
                "responseMessage": { "type": "string" }
              }
            },
            "RequestStats": {
              "type": "object",
              "properties": {
                "total": { "type": "integer" },
                "pending": { "type": "integer" },
                "accepted": { "type": "integer" },
                "rejected": { "type": "integer" }
              }
            },
            "UpdateMatch": {
              "type": "object",
              "properties": {
                "status": { "type": "string", "enum": ["ACTIVE", "PENDING_PAYMENT", "CONFIRMED", "COMPLETED", "CANCELLED"] },
                "moveInDate": { "type": "string", "format": "date" },
                "moveOutDate": { "type": "string", "format": "date" },
                "depositPaid": { "type": "boolean" },
                "contractSigned": { "type": "boolean" },
                "contractUrl": { "type": "string" }
              }
            },
            "RateMatch": {
              "type": "object",
              "required": ["rating"],
              "properties": {
                "rating": { "type": "number", "minimum": 1, "maximum": 5 },
                "review": { "type": "string" }
              }
            },
            "MatchStats": {
              "type": "object",
              "properties": {
                "total": { "type": "integer" },
                "active": { "type": "integer" },
                "completed": { "type": "integer" },
                "cancelled": { "type": "integer" }
              }
            },
            "Conversation": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "format": "uuid" },
                "matchId": { "type": "string", "format": "uuid" },
                "otherUser": {
                  "type": "object",
                  "properties": {
                    "id": { "type": "string", "format": "uuid" },
                    "firstName": { "type": "string" },
                    "lastName": { "type": "string" },
                    "avatar": { "type": "string" }
                  }
                },
                "room": {
                  "type": "object",
                  "properties": {
                    "id": { "type": "string", "format": "uuid" },
                    "name": { "type": "string" }
                  }
                },
                "lastMessage": {
                  "type": "object",
                  "properties": {
                    "content": { "type": "string" },
                    "createdAt": { "type": "string", "format": "date-time" }
                  }
                },
                "unreadCount": { "type": "integer" }
              }
            },
            "SendMessage": {
              "type": "object",
              "required": ["conversationId", "content"],
              "properties": {
                "conversationId": { "type": "string", "format": "uuid" },
                "type": { "type": "string", "enum": ["TEXT", "IMAGE", "FILE"], "default": "TEXT" },
                "content": { "type": "string" },
                "attachmentUrl": { "type": "string" }
              }
            },
            "PaginationMeta": {
              "type": "object",
              "properties": {
                "total": { "type": "integer" },
                "page": { "type": "integer" },
                "limit": { "type": "integer" },
                "totalPages": { "type": "integer" }
              }
            },
            "Error": {
              "type": "object",
              "properties": {
                "message": { "type": "string" },
                "error": { "type": "string" },
                "statusCode": { "type": "integer" }
              }
            }
          }
        },
        "security": [{ "bearerAuth": [] }]
      };

      window.ui = SwaggerUIBundle({
        spec: spec,
        dom_id: '#swagger-ui',
        deepLinking: true,
        presets: [
          SwaggerUIBundle.presets.apis,
          SwaggerUIStandalonePreset
        ],
        plugins: [
          SwaggerUIBundle.plugins.DownloadUrl
        ],
        layout: "StandaloneLayout",
        persistAuthorization: true,
        filter: true,
        tryItOutEnabled: true
      });
    };
  </script>
</body>
</html>
